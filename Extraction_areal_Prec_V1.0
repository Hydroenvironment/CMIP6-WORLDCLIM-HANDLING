################################################################################
#EXTRACTION OF PERCENTAGE ANOMALIES                                            #
#FROM CMIP6 CLIMATE MODEL DATASETS USING A POLYGON IN SHAPEFILE                #
################################################################################

#Author: Julio Montenegro Gambini, P.E. ASCE, M.Sc.,
#PhD fellow - Technische Universiteit Delft (TU Delft), Netherlands.

#Current version: 1.0
# © Copyright 2021 Julio Montenegro.
# This script is strictly under license GPLv3
# License details: https://www.gnu.org/licenses/gpl-3.0.en.html

# Please, when using this script, cite as: "Montenegro, J. (2021).Treatment of
# of CMIP6-WorldClim downscaled information using R"

#The data used here are CMIP6 downscaled future climate projections. 
#The downscaling and calibration (bias correction) was done with WorldClim 
#v2.1 as baseline climate.
#More info: https://www.worldclim.org/data/cmip6/cmip6climate.html

#REQUIRED PACKAGES AND INDICATIONS!!=============================================
library(raster)
library(data.table)
library(dplyr)
library(xlsx)
#Important note: Please, given the script structure, try to generate with different 
#folders the same path with equal folder names and .tif files as possible to
#avoid wrong calculations.

#Shapefile must contain only one polygon.

#Useful examples for data names:
#-Annual files must be named with: "_CNRM-CM6-1_ssp126_2021-2040.tif"
#-Seasonal anomaly files must be named as: "_CNRM-CM6-1_anual_2041-2060_ssp370.tif"
#-Seasonal anomaly files must be named as: "_CNRM-ESM2-1_autumn_2061-2080_ssp370.tif"

#Try to run some sections of the script separately or just run the entire
#script. Each section enable different directories, don`t change them
#randomly to avoid wrong calculations.

#Don`t generate .xml or other files inside each model output folder!!!
#Only .tif files are allowed on the use of this script

#SETTING MAIN WORKING DIRECTORIES===============================================
wdir="D:/RESEARCH/CMIP6 ASESSMENT PERU/CMIP6 RASTERS/pr"
wd_anom_anual="D:/RESEARCH/CMIP6 ASESSMENT PERU/CMIP6 RASTERS/anomalías/Anom_anuales"
wd_anom_seasonal="D:/RESEARCH/CMIP6 ASESSMENT PERU/CMIP6 RASTERS/anomalías/Anom_estacionales"

#LOADING THE POLYGON SHAPEFILE===================================================== 
area_pol = shapefile("C:/Users/Julio/Documents/GIS DataBase/Limite_departamental/Peru_simple_WGS84GEO.shp")
#ANNUAL PRECIPITATION ##################################################### ####
#BCC-CSM2-MR====================================================================
setwd(wdir)
#SSP126
data_126_2021_2040<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("BCC-CSM2-MR/_BCC-CSM2-MR_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_BCC_CSM2_MR<-full_join(PP_a,PP_b)
rownames(PP_BCC_CSM2_MR)<-c("ssp126","ssp245","ssp370","ssp585")

#CanESM5========================================================================
#SSP126
data_126_2021_2040<-stack("CanESM5/_CanESM5_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("CanESM5/_CanESM5_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("CanESM5/_CanESM5_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("CanESM5/_CanESM5_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("CanESM5/_CanESM5_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("CanESM5/_CanESM5_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("CanESM5/_CanESM5_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("CanESM5/_CanESM5_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("CanESM5/_CanESM5_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("CanESM5/_CanESM5_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("CanESM5/_CanESM5_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("CanESM5/_CanESM5_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("CanESM5/_CanESM5_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("CanESM5/_CanESM5_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("CanESM5/_CanESM5_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("CanESM5/_CanESM5_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CanESM5<-full_join(PP_a,PP_b)
rownames(PP_CanESM5)<-c("ssp126","ssp245","ssp370","ssp585")



writeRaster()
#CNRM-CM6-1=====================================================================
#SSP126
data_126_2021_2040<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("CNRM-CM6-1/_CNRM-CM6-1_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_CM6_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_CM6_1)<-c("ssp126","ssp245","ssp370","ssp585")

#CNRM-ESM2-1====================================================================
#SSP126
data_126_2021_2040<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("CNRM-ESM2-1/_CNRM-ESM2-1_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_ESM2_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_ESM2_1)<-c("ssp126","ssp245","ssp370","ssp585")


#GFDL-ESM4====================================================================
#SSP126
data_126_2021_2040<-stack("GFDL-ESM4/_GFDL-ESM4_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("GFDL-ESM4/_GFDL-ESM4_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("GFDL-ESM4/_GFDL-ESM4_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("GFDL-ESM4/_GFDL-ESM4_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("GFDL-ESM4/_GFDL-ESM4_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("GFDL-ESM4/_GFDL-ESM4_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("GFDL-ESM4/_GFDL-ESM4_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("GFDL-ESM4/_GFDL-ESM4_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("GFDL-ESM4/_GFDL-ESM4_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("GFDL-ESM4/_GFDL-ESM4_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("GFDL-ESM4/_GFDL-ESM4_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("GFDL-ESM4/_GFDL-ESM4_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-PP_126
PP_b<-full_join(PP_370,PP_585)
PP_GFDL_ESM4<-full_join(PP_a,PP_b)
rownames(PP_GFDL_ESM4)<-c("ssp126","ssp370","ssp585")


#IPSL-CM6A-LR===================================================================
#SSP126
data_126_2021_2040<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("IPSL-CM6A-LR/_IPSL-CM6A-LR_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_IPSL_CM6A_LR<-full_join(PP_a,PP_b)
rownames(PP_IPSL_CM6A_LR)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC6=========================================================================
#SSP126
data_126_2021_2040<-stack("MIROC6/_MIROC6_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("MIROC6/_MIROC6_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("MIROC6/_MIROC6_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("MIROC6/_MIROC6_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("MIROC6/_MIROC6_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("MIROC6/_MIROC6_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("MIROC6/_MIROC6_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("MIROC6/_MIROC6_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("MIROC6/_MIROC6_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("MIROC6/_MIROC6_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("MIROC6/_MIROC6_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("MIROC6/_MIROC6_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("MIROC6/_MIROC6_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("MIROC6/_MIROC6_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("MIROC6/_MIROC6_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("MIROC6/_MIROC6_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC6<-full_join(PP_a,PP_b)
rownames(PP_MIROC6)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC-ES2L=====================================================================
#SSP126
data_126_2021_2040<-stack("MIROC-ES2L/_MIROC-ES2L_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("MIROC-ES2L/_MIROC-ES2L_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("MIROC-ES2L/_MIROC-ES2L_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("MIROC-ES2L/_MIROC-ES2L_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("MIROC-ES2L/_MIROC-ES2L_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("MIROC-ES2L/_MIROC-ES2L_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("MIROC-ES2L/_MIROC-ES2L_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("MIROC-ES2L/_MIROC-ES2L_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("MIROC-ES2L/_MIROC-ES2L_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("MIROC-ES2L/_MIROC-ES2L_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("MIROC-ES2L/_MIROC-ES2L_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("MIROC-ES2L/_MIROC-ES2L_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("MIROC-ES2L/_MIROC-ES2L_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("MIROC-ES2L/_MIROC-ES2L_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("MIROC-ES2L/_MIROC-ES2L_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("MIROC-ES2L/_MIROC-ES2L_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC_ES2L<-full_join(PP_a,PP_b)
rownames(PP_MIROC_ES2L)<-c("ssp126","ssp245","ssp370","ssp585")


#MRI-ESM2-0=====================================================================
#SSP126
data_126_2021_2040<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp126_2021-2040.tif")
datasum_126_2021_2040 <- calc(data_126_2021_2040, sum)
data_126_2041_2060<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp126_2041-2060.tif")
datasum_126_2041_2060 <- calc(data_126_2041_2060, sum)
data_126_2061_2080<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp126_2061-2080.tif")
datasum_126_2061_2080 <- calc(data_126_2061_2080, sum)
data_126_2081_2100<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp126_2081-2100.tif")
datasum_126_2081_2100 <- calc(data_126_2081_2100, sum)
PP_126_2021_2040<-data.table(extract(datasum_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(datasum_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(datasum_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(datasum_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
data_245_2021_2040<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp245_2021-2040.tif")
datasum_245_2021_2040 <- calc(data_245_2021_2040, sum)
data_245_2041_2060<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp245_2041-2060.tif")
datasum_245_2041_2060 <- calc(data_245_2041_2060, sum)
data_245_2061_2080<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp245_2061-2080.tif")
datasum_245_2061_2080 <- calc(data_245_2061_2080, sum)
data_245_2081_2100<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp245_2081-2100.tif")
datasum_245_2081_2100 <- calc(data_245_2081_2100, sum)
PP_245_2021_2040<-data.table(extract(datasum_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(datasum_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(datasum_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(datasum_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
data_370_2021_2040<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp370_2021-2040.tif")
datasum_370_2021_2040 <- calc(data_370_2021_2040, sum)
data_370_2041_2060<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp370_2041-2060.tif")
datasum_370_2041_2060 <- calc(data_370_2041_2060, sum)
data_370_2061_2080<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp370_2061-2080.tif")
datasum_370_2061_2080 <- calc(data_370_2061_2080, sum)
data_370_2081_2100<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp370_2081-2100.tif")
datasum_370_2081_2100 <- calc(data_370_2081_2100, sum)
PP_370_2021_2040<-data.table(extract(datasum_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(datasum_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(datasum_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(datasum_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
data_585_2021_2040<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp585_2021-2040.tif")
datasum_585_2021_2040 <- calc(data_585_2021_2040, sum)
data_585_2041_2060<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp585_2041-2060.tif")
datasum_585_2041_2060 <- calc(data_585_2041_2060, sum)
data_585_2061_2080<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp585_2061-2080.tif")
datasum_585_2061_2080 <- calc(data_585_2061_2080, sum)
data_585_2081_2100<-stack("MRI-ESM2-0/_MRI-ESM2-0_ssp585_2081-2100.tif")
datasum_585_2081_2100 <- calc(data_585_2081_2100, sum)
PP_585_2021_2040<-data.table(extract(datasum_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(datasum_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(datasum_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(datasum_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MRI_ESM2_0<-full_join(PP_a,PP_b)
rownames(PP_MRI_ESM2_0)<-c("ssp126","ssp245","ssp370","ssp585")

#Exporting annual precipitation values in xlsx file=========================================================
write.xlsx(PP_BCC_CSM2_MR, file="Peru_CMIP6.xlsx", sheetName = "BCC-CSM2-MR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CanESM5, file="Peru_CMIP6.xlsx", sheetName = "CanESM5", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_CM6_1, file="Peru_CMIP6.xlsx", sheetName = "CNRM-CM6-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_ESM2_1, file="Peru_CMIP6.xlsx", sheetName = "CNRM-ESM2-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_GFDL_ESM4, file="Peru_CMIP6.xlsx", sheetName = "GFDL-ESM4", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_IPSL_CM6A_LR, file="Peru_CMIP6.xlsx", sheetName = "IPSL-CM6A-LR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC6, file="Peru_CMIP6.xlsx", sheetName = "MIROC6", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC_ES2L, file="Peru_CMIP6.xlsx", sheetName = "MIROC-ES2L", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MRI_ESM2_0, file="Peru_CMIP6.xlsx", sheetName = "MRI-ESM2-0", 
           col.names = TRUE, row.names = TRUE, append = TRUE)


########CALCULATION OF ANOMALIES ########################################## ####
#ANNUAL ANOMALIES ######################################################### ####
#BCC-CSM2-MR====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("BCC-CSM2-MR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("BCC-CSM2-MR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("BCC-CSM2-MR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("BCC-CSM2-MR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_BCC_CSM2_MR<-full_join(PP_a,PP_b)
rownames(PP_BCC_CSM2_MR)<-c("ssp126","ssp245","ssp370","ssp585")


#CanESM5====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("CanESM5/ssp126/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("CanESM5/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("CanESM5/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("CanESM5/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CanESM5<-full_join(PP_a,PP_b)
rownames(PP_CanESM5)<-c("ssp126","ssp245","ssp370","ssp585")



#CNRM-CM6-1====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("CNRM-CM6-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("CNRM-CM6-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("CNRM-CM6-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("CNRM-CM6-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_CM6_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_CM6_1)<-c("ssp126","ssp245","ssp370","ssp585")


#CNRM-ESM2-1====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("CNRM-ESM2-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("CNRM-ESM2-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("CNRM-ESM2-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("CNRM-ESM2-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_ESM2_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_ESM2_1)<-c("ssp126","ssp245","ssp370","ssp585")


#GFDL-ESM4====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("GFDL-ESM4/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("GFDL-ESM4/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("GFDL-ESM4/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("GFDL-ESM4/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-PP_126
PP_b<-full_join(PP_370,PP_585)
PP_GFDL_ESM4<-full_join(PP_a,PP_b)
rownames(PP_GFDL_ESM4)<-c("ssp126","ssp370","ssp585")


#IPSL-CM6A-LR====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("IPSL-CM6A-LR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("IPSL-CM6A-LR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("IPSL-CM6A-LR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("IPSL-CM6A-LR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_IPSL_CM6A_LR<-full_join(PP_a,PP_b)
rownames(PP_IPSL_CM6A_LR)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC6====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("MIROC6/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("MIROC6/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("MIROC6/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("MIROC6/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC6<-full_join(PP_a,PP_b)
rownames(PP_MIROC6)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC_ES2L====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("MIROC-ES2L/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("MIROC-ES2L/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("MIROC-ES2L/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("MIROC-ES2L/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC_ES2L<-full_join(PP_a,PP_b)
rownames(PP_MIROC_ES2L)<-c("ssp126","ssp245","ssp370","ssp585")


#MRI-ESM2-0====================================================================
#SSP126
setwd(wd_anom_anual)
setwd("MRI-ESM2-0/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_anual)
setwd("MRI-ESM2-0/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_anual)
setwd("MRI-ESM2-0/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_anual)
setwd("MRI-ESM2-0/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MRI_ESM2_0<-full_join(PP_a,PP_b)
rownames(PP_MRI_ESM2_0)<-c("ssp126","ssp245","ssp370","ssp585")


#Exporting annual anomalies in xlsx file=========================================================
setwd(wd_anom_anual)
write.xlsx(PP_BCC_CSM2_MR, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "BCC-CSM2-MR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CanESM5, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "CanESM5", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_CM6_1, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-CM6-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_ESM2_1, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-ESM2-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_GFDL_ESM4, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "GFDL-ESM4", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_IPSL_CM6A_LR, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "IPSL-CM6A-LR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC6, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC6", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC_ES2L, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC-ES2L", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MRI_ESM2_0, file="Annual_anomaly_Peru_CMIP6.xlsx", sheetName = "MRI-ESM2-0", 
           col.names = TRUE, row.names = TRUE, append = TRUE)


################################################################################
#SEASONAL ANOMALIES ####################################################### #### 
#AUTUMN SEASON############################################################# #### 
#BCC-CSM2-MR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_BCC_CSM2_MR<-full_join(PP_a,PP_b)
rownames(PP_BCC_CSM2_MR)<-c("ssp126","ssp245","ssp370","ssp585")


#CanESM5====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp126/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CanESM5<-full_join(PP_a,PP_b)
rownames(PP_CanESM5)<-c("ssp126","ssp245","ssp370","ssp585")



#CNRM-CM6-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_CM6_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_CM6_1)<-c("ssp126","ssp245","ssp370","ssp585")


#CNRM-ESM2-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_ESM2_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_ESM2_1)<-c("ssp126","ssp245","ssp370","ssp585")


#GFDL-ESM4====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-PP_126
PP_b<-full_join(PP_370,PP_585)
PP_GFDL_ESM4<-full_join(PP_a,PP_b)
rownames(PP_GFDL_ESM4)<-c("ssp126","ssp370","ssp585")


#IPSL-CM6A-LR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_IPSL_CM6A_LR<-full_join(PP_a,PP_b)
rownames(PP_IPSL_CM6A_LR)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC6====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC6<-full_join(PP_a,PP_b)
rownames(PP_MIROC6)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC_ES2L====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC_ES2L<-full_join(PP_a,PP_b)
rownames(PP_MIROC_ES2L)<-c("ssp126","ssp245","ssp370","ssp585")


#MRI-ESM2-0====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "autumn_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "autumn_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "autumn_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "autumn_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MRI_ESM2_0<-full_join(PP_a,PP_b)
rownames(PP_MRI_ESM2_0)<-c("ssp126","ssp245","ssp370","ssp585")


#Exporting as xlsx file=========================================================
setwd(wd_anom_seasonal)
write.xlsx(PP_BCC_CSM2_MR, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "BCC-CSM2-MR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CanESM5, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "CanESM5", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_CM6_1, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-CM6-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_ESM2_1, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-ESM2-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_GFDL_ESM4, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "GFDL-ESM4", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_IPSL_CM6A_LR, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "IPSL-CM6A-LR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC6, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC6", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC_ES2L, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC-ES2L", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MRI_ESM2_0, file="Autumn_anomaly_Peru_CMIP6.xlsx", sheetName = "MRI-ESM2-0", 
           col.names = TRUE, row.names = TRUE, append = TRUE)

#SPRING SEASON############################################################# #### 
#BCC-CSM2-MR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_BCC_CSM2_MR<-full_join(PP_a,PP_b)
rownames(PP_BCC_CSM2_MR)<-c("ssp126","ssp245","ssp370","ssp585")


#CanESM5====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp126/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CanESM5<-full_join(PP_a,PP_b)
rownames(PP_CanESM5)<-c("ssp126","ssp245","ssp370","ssp585")



#CNRM-CM6-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_CM6_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_CM6_1)<-c("ssp126","ssp245","ssp370","ssp585")


#CNRM-ESM2-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_ESM2_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_ESM2_1)<-c("ssp126","ssp245","ssp370","ssp585")


#GFDL-ESM4====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-PP_126
PP_b<-full_join(PP_370,PP_585)
PP_GFDL_ESM4<-full_join(PP_a,PP_b)
rownames(PP_GFDL_ESM4)<-c("ssp126","ssp370","ssp585")


#IPSL-CM6A-LR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_IPSL_CM6A_LR<-full_join(PP_a,PP_b)
rownames(PP_IPSL_CM6A_LR)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC6====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC6<-full_join(PP_a,PP_b)
rownames(PP_MIROC6)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC_ES2L====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC_ES2L<-full_join(PP_a,PP_b)
rownames(PP_MIROC_ES2L)<-c("ssp126","ssp245","ssp370","ssp585")


#MRI-ESM2-0====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "spring_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "spring_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "spring_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "spring_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MRI_ESM2_0<-full_join(PP_a,PP_b)
rownames(PP_MRI_ESM2_0)<-c("ssp126","ssp245","ssp370","ssp585")


#Exporting as xlsx file=========================================================
setwd(wd_anom_seasonal)
write.xlsx(PP_BCC_CSM2_MR, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "BCC-CSM2-MR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CanESM5, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "CanESM5", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_CM6_1, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-CM6-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_ESM2_1, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-ESM2-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_GFDL_ESM4, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "GFDL-ESM4", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_IPSL_CM6A_LR, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "IPSL-CM6A-LR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC6, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC6", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC_ES2L, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC-ES2L", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MRI_ESM2_0, file="Spring_anomaly_Peru_CMIP6.xlsx", sheetName = "MRI-ESM2-0", 
           col.names = TRUE, row.names = TRUE, append = TRUE)

##############################################################################==
#SUMMER SEASON
#SUMMER SEASON############################################################# #### 
#BCC-CSM2-MR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_BCC_CSM2_MR<-full_join(PP_a,PP_b)
rownames(PP_BCC_CSM2_MR)<-c("ssp126","ssp245","ssp370","ssp585")


#CanESM5====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp126/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CanESM5<-full_join(PP_a,PP_b)
rownames(PP_CanESM5)<-c("ssp126","ssp245","ssp370","ssp585")



#CNRM-CM6-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_CM6_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_CM6_1)<-c("ssp126","ssp245","ssp370","ssp585")


#CNRM-ESM2-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_ESM2_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_ESM2_1)<-c("ssp126","ssp245","ssp370","ssp585")


#GFDL-ESM4====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-PP_126
PP_b<-full_join(PP_370,PP_585)
PP_GFDL_ESM4<-full_join(PP_a,PP_b)
rownames(PP_GFDL_ESM4)<-c("ssp126","ssp370","ssp585")


#IPSL-CM6A-LR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_IPSL_CM6A_LR<-full_join(PP_a,PP_b)
rownames(PP_IPSL_CM6A_LR)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC6====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC6<-full_join(PP_a,PP_b)
rownames(PP_MIROC6)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC_ES2L====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC_ES2L<-full_join(PP_a,PP_b)
rownames(PP_MIROC_ES2L)<-c("ssp126","ssp245","ssp370","ssp585")


#MRI-ESM2-0====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "summer_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "summer_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "summer_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "summer_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MRI_ESM2_0<-full_join(PP_a,PP_b)
rownames(PP_MRI_ESM2_0)<-c("ssp126","ssp245","ssp370","ssp585")


#Exporting as xlsx file=========================================================
setwd(wd_anom_seasonal)
write.xlsx(PP_BCC_CSM2_MR, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "BCC-CSM2-MR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CanESM5, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "CanESM5", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_CM6_1, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-CM6-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_ESM2_1, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-ESM2-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_GFDL_ESM4, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "GFDL-ESM4", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_IPSL_CM6A_LR, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "IPSL-CM6A-LR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC6, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC6", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC_ES2L, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC-ES2L", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MRI_ESM2_0, file="Summer_anomaly_Peru_CMIP6.xlsx", sheetName = "MRI-ESM2-0", 
           col.names = TRUE, row.names = TRUE, append = TRUE)

#WINTER SEASON############################################################# #### 
#BCC-CSM2-MR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("BCC-CSM2-MR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_BCC_CSM2_MR<-full_join(PP_a,PP_b)
rownames(PP_BCC_CSM2_MR)<-c("ssp126","ssp245","ssp370","ssp585")


#CanESM5====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp126/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CanESM5/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CanESM5<-full_join(PP_a,PP_b)
rownames(PP_CanESM5)<-c("ssp126","ssp245","ssp370","ssp585")



#CNRM-CM6-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-CM6-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_CM6_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_CM6_1)<-c("ssp126","ssp245","ssp370","ssp585")


#CNRM-ESM2-1====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("CNRM-ESM2-1/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_CNRM_ESM2_1<-full_join(PP_a,PP_b)
rownames(PP_CNRM_ESM2_1)<-c("ssp126","ssp245","ssp370","ssp585")


#GFDL-ESM4====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("GFDL-ESM4/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-PP_126
PP_b<-full_join(PP_370,PP_585)
PP_GFDL_ESM4<-full_join(PP_a,PP_b)
rownames(PP_GFDL_ESM4)<-c("ssp126","ssp370","ssp585")


#IPSL-CM6A-LR====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("IPSL-CM6A-LR/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_IPSL_CM6A_LR<-full_join(PP_a,PP_b)
rownames(PP_IPSL_CM6A_LR)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC6====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC6/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC6<-full_join(PP_a,PP_b)
rownames(PP_MIROC6)<-c("ssp126","ssp245","ssp370","ssp585")


#MIROC_ES2L====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MIROC-ES2L/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MIROC_ES2L<-full_join(PP_a,PP_b)
rownames(PP_MIROC_ES2L)<-c("ssp126","ssp245","ssp370","ssp585")


#MRI-ESM2-0====================================================================
#SSP126
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp126/")
data_126_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp126.tif"))
data_126_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp126.tif"))
data_126_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp126.tif"))
data_126_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp126.tif"))
PP_126_2021_2040<-data.table(extract(data_126_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_126_2041_2060<-data.table(extract(data_126_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_126_2061_2080<-data.table(extract(data_126_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_126_2081_2100<-data.table(extract(data_126_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_126<-data.frame(c(PP_126_2021_2040,PP_126_2041_2060,PP_126_2061_2080,PP_126_2081_2100))
colnames(PP_126)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP245
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp245/")
data_245_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp245.tif"))
data_245_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp245.tif"))
data_245_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp245.tif"))
data_245_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp245.tif"))
PP_245_2021_2040<-data.table(extract(data_245_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_245_2041_2060<-data.table(extract(data_245_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_245_2061_2080<-data.table(extract(data_245_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_245_2081_2100<-data.table(extract(data_245_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_245<-data.frame(c(PP_245_2021_2040,PP_245_2041_2060,PP_245_2061_2080,PP_245_2081_2100))
colnames(PP_245)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP370
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp370/")
data_370_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp370.tif"))
data_370_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp370.tif"))
data_370_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp370.tif"))
data_370_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp370.tif"))
PP_370_2021_2040<-data.table(extract(data_370_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_370_2041_2060<-data.table(extract(data_370_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_370_2061_2080<-data.table(extract(data_370_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_370_2081_2100<-data.table(extract(data_370_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_370<-data.frame(c(PP_370_2021_2040,PP_370_2041_2060,PP_370_2061_2080,PP_370_2081_2100))
colnames(PP_370)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

#SSP585
setwd(wd_anom_seasonal)
setwd("MRI-ESM2-0/ssp585/")
data_585_2021_2040<-raster(list.files(pattern = "winter_2021-2040_ssp585.tif"))
data_585_2041_2060<-raster(list.files(pattern = "winter_2041-2060_ssp585.tif"))
data_585_2061_2080<-raster(list.files(pattern = "winter_2061-2080_ssp585.tif"))
data_585_2081_2100<-raster(list.files(pattern = "winter_2081-2100_ssp585.tif"))
PP_585_2021_2040<-data.table(extract(data_585_2021_2040,area_pol,fun=mean,na.rm = TRUE))
PP_585_2041_2060<-data.table(extract(data_585_2041_2060,area_pol,fun=mean,na.rm = TRUE))
PP_585_2061_2080<-data.table(extract(data_585_2061_2080,area_pol,fun=mean,na.rm = TRUE))
PP_585_2081_2100<-data.table(extract(data_585_2081_2100,area_pol,fun=mean,na.rm = TRUE))
PP_585<-data.frame(c(PP_585_2021_2040,PP_585_2041_2060,PP_585_2061_2080,PP_585_2081_2100))
colnames(PP_585)<-c("2021-2040","2041-2060","2061-2080","2081-2100")

PP_a<-full_join(PP_126,PP_245)
PP_b<-full_join(PP_370,PP_585)
PP_MRI_ESM2_0<-full_join(PP_a,PP_b)
rownames(PP_MRI_ESM2_0)<-c("ssp126","ssp245","ssp370","ssp585")


#Exporting as xlsx file=========================================================
setwd(wd_anom_seasonal)
write.xlsx(PP_BCC_CSM2_MR, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "BCC-CSM2-MR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CanESM5, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "CanESM5", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_CM6_1, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-CM6-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_CNRM_ESM2_1, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "CNRM-ESM2-1", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_GFDL_ESM4, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "GFDL-ESM4", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_IPSL_CM6A_LR, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "IPSL-CM6A-LR", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC6, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC6", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MIROC_ES2L, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "MIROC-ES2L", 
           col.names = TRUE, row.names = TRUE, append = TRUE)
write.xlsx(PP_MRI_ESM2_0, file="Winter_anomaly_Peru_CMIP6.xlsx", sheetName = "MRI-ESM2-0", 
           col.names = TRUE, row.names = TRUE, append = TRUE)

##############################################################################==
